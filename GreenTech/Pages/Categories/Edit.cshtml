@page "{id:int}"
@model GreenTech.Pages.Categories.EditModel
@{
    ViewData["Title"] = "Sửa danh mục";
}

<div class="mb-6">
    <h1 class="text-3xl font-bold text-gray-900">Sửa danh mục</h1>
    <p class="text-gray-600 mt-2">Cập nhật thông tin danh mục</p>
</div>

@if (Model.CategoryDetails == null)
{
    <div class="bg-red-50 border border-red-200 rounded-lg p-4">
        <p class="text-red-800">Không tìm thấy danh mục này.</p>
        <a asp-page="./Index" class="text-red-600 hover:underline mt-2 inline-block">Quay lại danh sách</a>
    </div>
}
else
{
    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
        <form method="post" enctype="multipart/form-data">
            <input type="hidden" asp-for="Id" />
            
            <div class="grid grid-cols-2 gap-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Tên danh mục *</label>
                    <input asp-for="Category.Name" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500" />
                    <span asp-validation-for="Category.Name" class="text-red-500 text-xs"></span>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Slug *</label>
                    <input asp-for="Category.Slug" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500" />
                    <span asp-validation-for="Category.Slug" class="text-red-500 text-xs"></span>
                </div>

                <div class="col-span-2">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Hình ảnh</label>
                    <input asp-for="ImageFile" type="file" accept="image/*" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500" />
                    <span asp-validation-for="ImageFile" class="text-red-500 text-xs"></span>
                    @if (!string.IsNullOrWhiteSpace(Model.CategoryDetails?.Image))
                    {
                        <div class="mt-2">
                            <img src="@Model.CategoryDetails.Image" alt="Current image" class="h-16 rounded border" />
                        </div>
                    }
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Danh mục cha</label>
                    <select asp-for="Category.ParentId" asp-items="Model.ParentCategories" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                        <option value="">Không có (Danh mục gốc)</option>
                    </select>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Thứ tự sắp xếp</label>
                    <input asp-for="Category.SortOrder" type="number" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500" />
                    <span asp-validation-for="Category.SortOrder" class="text-red-500 text-xs"></span>
                </div>

                <div class="col-span-2">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Mô tả *</label>
                    <textarea asp-for="Category.Description" rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"></textarea>
                    <span asp-validation-for="Category.Description" class="text-red-500 text-xs"></span>
                </div>

                <div>
                    <label class="flex items-center">
                        <input asp-for="Category.IsActive" type="checkbox" class="rounded border-gray-300 text-green-600 focus:ring-green-500" />
                        <span class="ml-2 text-sm text-gray-700">Hoạt động</span>
                    </label>
                </div>
            </div>

            <div class="mt-6 flex gap-3">
                <button type="submit" class="px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">Cập nhật</button>
                <a asp-page="./Index" class="px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">Hủy</a>
            </div>
        </form>
    </div>
}

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}

